import pandas as pd
import numpy as np
import csv
import matplotlib.pyplot as plt

# Data for the tables
data = {
    "Seed_2": {
        0: [92.50, 81.50, 84.70, 88.80, 80.20, 66.10],
        1: [65.20, 56.50, 57.70, 56.60, 54.90, 55.90],
        2: [89.80, 73.60, 71.60, 67.90, 64.30, 64.80],
        3: [77.90, 51.90, 66.00, 52.60, 65.40, 15.90],
        4: [49.10, 47.70, 48.60, 47.10, 47.90, 55.70],
        5: [91.90, 81.50, 86.20, 90.20, 81.90, 67.20],
        6: [59.80, 53.30, 55.00, 57.60, 51.40, 60.90],
        7: [74.60, 50.20, 67.20, 48.70, 63.60, 14.40],
        8: [67.70, 54.10, 61.10, 44.00, 39.70, 35.10],
        9: [53.60, 62.00, 63.80, 60.90, 66.40, 56.70],
        10: [48.00, 48.20, 48.90, 46.50, 46.50, 55.50],
        11: [85.20, 73.20, 77.20, 72.40, 63.40, 36.30],
        12: [71.00, 65.40, 70.20, 66.50, 70.70, 57.60],
        13: [58.10, 53.50, 53.10, 57.20, 51.50, 62.20],
        14: [59.90, 61.70, 44.90, 45.00, 23.80, 13.80],
        15: [45.60, 48.40, 49.20, 53.40, 47.90, 60.90],
    },
    "Seed_27": {
        0: [93.00, 86.90, 83.60, 83.30, 81.00, 68.70],
        1: [65.60, 58.40, 53.20, 56.20, 56.30, 62.20],
        2: [72.30, 59.00, 68.20, 73.20, 76.50, 68.30],
        3: [69.10, 84.70, 22.80, 53.80, 32.80, 27.20],
        4: [47.80, 47.50, 49.20, 48.00, 55.90, 55.20],
        5: [93.40, 87.70, 85.00, 82.70, 81.80, 68.60],
        6: [57.40, 52.90, 54.20, 55.20, 57.30, 59.10],
        7: [68.60, 84.50, 22.80, 55.20, 33.80, 25.20],
        8: [59.60, 52.90, 46.10, 43.60, 30.00, 31.90],
        9: [69.60, 66.10, 67.00, 60.10, 52.10, 54.80],
        10: [46.40, 47.20, 49.20, 47.10, 56.40, 55.50],
        11: [84.80, 85.20, 57.70, 66.30, 51.30, 36.70],
        12: [55.20, 69.90, 69.90, 65.50, 52.80, 61.10],
        13: [57.00, 52.10, 52.90, 55.00, 58.20, 62.10],
        14: [64.40, 67.50, 37.70, 49.80, 12.70, 12.20],
        15: [46.40, 47.90, 48.60, 54.20, 57.20, 57.30],
    },
    "Seed_101": {
        0: [94.60, 86.40, 89.20, 84.70, 81.90, 66.30],
        1: [57.30, 60.10, 58.60, 53.90, 58.90, 57.10],
        2: [86.40, 73.40, 61.80, 88.00, 54.50, 66.40],
        3: [82.10, 82.10, 78.80, 50.30, 46.80, 29.50],
        4: [47.10, 46.70, 48.90, 50.70, 49.80, 49.00],
        5: [93.50, 86.10, 89.90, 86.90, 84.60, 67.60],
        6: [55.90, 53.70, 56.80, 60.60, 56.60, 59.20],
        7: [82.60, 83.50, 78.50, 48.20, 46.80, 31.10],
        8: [52.90, 54.80, 39.00, 46.40, 34.50, 43.70],
        9: [59.90, 74.90, 68.80, 59.70, 64.50, 55.10],
        10: [46.40, 46.50, 47.80, 50.40, 48.80, 49.10],
        11: [91.50, 76.70, 81.70, 68.30, 66.10, 49.60],
        12: [62.80, 67.50, 72.90, 67.40, 68.60, 54.00],
        13: [53.10, 52.20, 55.70, 59.60, 53.10, 59.70],
        14: [87.10, 65.90, 49.30, 33.00, 44.50, 38.20],
        15: [46.40, 47.20, 51.40, 56.10, 50.50, 53.40],
    },
    "Seed_426": {
        0: [97.50, 90.30, 91.70, 78.90, 78.10, 69.90],
        1: [62.00, 60.30, 66.40, 52.50, 57.70, 55.70],
        2: [77.20, 77.60, 50.10, 63.90, 51.60, 63.90],
        3: [82.10, 73.80, 81.00, 54.60, 75.00, 29.80],
        4: [47.80, 48.40, 50.40, 47.90, 47.90, 51.50],
        5: [97.10, 91.00, 92.40, 80.40, 81.00, 72.20],
        6: [53.50, 58.00, 60.20, 50.30, 54.30, 56.50],
        7: [80.50, 72.80, 80.90, 51.60, 74.10, 25.80],
        8: [52.10, 56.90, 47.50, 38.70, 29.40, 27.40],
        9: [83.90, 54.70, 79.10, 75.70, 62.50, 57.90],
        10: [46.80, 48.40, 51.60, 49.00, 46.60, 50.10],
        11: [87.80, 80.60, 81.70, 64.70, 66.60, 51.10],
        12: [78.90, 61.00, 74.00, 76.30, 65.70, 57.80],
        13: [54.60, 57.80, 58.90, 49.60, 52.70, 58.20],
        14: [70.60, 77.00, 47.70, 54.50, 45.60, 34.00],
        15: [48.30, 49.40, 54.10, 47.70, 48.70, 50.90],
    },
    "Seed_2323": {
        0: [91.10, 92.30, 86.20, 86.20, 82.80, 61.10],
        1: [69.50, 58.30, 59.20, 58.00, 58.10, 59.30],
        2: [89.30, 62.80, 87.40, 71.10, 67.00, 68.40],
        3: [93.00, 78.30, 67.80, 41.70, 42.10, 24.60],
        4: [48.10, 50.00, 50.00, 43.70, 49.10, 53.30],
        5: [91.20, 91.80, 88.80, 86.50, 84.20, 60.10],
        6: [61.20, 55.60, 60.50, 54.20, 55.30, 60.40],
        7: [91.20, 75.80, 64.20, 40.70, 43.50, 24.20],
        8: [59.90, 46.70, 51.90, 45.20, 40.60, 35.90],
        9: [57.60, 75.50, 59.60, 69.60, 66.30, 51.80],
        10: [47.00, 49.70, 49.70, 45.30, 49.80, 52.60],
        11: [93.50, 78.10, 80.20, 68.50, 58.50, 43.70],
        12: [55.70, 79.10, 63.50, 68.60, 55.30, 55.00],
        13: [59.70, 54.00, 60.30, 54.90, 55.80, 62.80],
        14: [92.30, 48.50, 49.30, 41.40, 77.20, 10.80],
        15: [48.40, 51.70, 54.70, 47.70, 50.80, 61.20],
    },
}


error_rates = ["0%", "5%", "10%", "15%", "25%", "50%"]

average_accuracy_by_error_rate = pd.DataFrame()

for struct_type in range(16): 
    avg_accuracies = []
    for error_idx in range(6):  
        avg_accuracy = np.mean(
            [
                data["Seed_2"][struct_type][error_idx],
                data["Seed_27"][struct_type][error_idx],
                data["Seed_101"][struct_type][error_idx],
                data["Seed_426"][struct_type][error_idx],
                data["Seed_2323"][struct_type][error_idx],
            ]
        )
        avg_accuracies.append(avg_accuracy)

    struct_data = {
        "Structure Type": struct_type,
        **dict(zip(error_rates, avg_accuracies)),
    }
    average_accuracy_by_error_rate = pd.concat(
        [average_accuracy_by_error_rate, pd.DataFrame([struct_data])], ignore_index=True
    )


average_accuracy_by_error_rate.to_csv("average_accuracy_by_error_rate.csv", index=False)

plt.figure(figsize=(12, 8))
for struct_type in average_accuracy_by_error_rate["Structure Type"].unique():
    plt.plot(
        error_rates,
        average_accuracy_by_error_rate[average_accuracy_by_error_rate["Structure Type"] == struct_type].iloc[0, 1:],
        marker="o",
        label=f"Structure {int(struct_type)}",
    )

plt.title("Trends of Average Accuracy by Structure Type and Error Rate", fontsize=14)
plt.xlabel("Error Rate", fontsize=12)
plt.ylabel("Average Accuracy (%)", fontsize=12)
plt.xticks(fontsize=10)
plt.yticks(fontsize=10)
plt.legend(title="Structure Type", bbox_to_anchor=(1.05, 1), loc="upper left", fontsize=9)
plt.grid(visible=True, linestyle="--", linewidth=0.5)
plt.tight_layout()
plt.show()
